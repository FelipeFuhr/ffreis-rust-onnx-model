ARG BASE_IMAGE=__BASE_IMAGE__
ARG BASE_DIGEST=__BASE_DIGEST__
FROM ${BASE_IMAGE}@${BASE_DIGEST}

# Create unprivileged user
RUN groupadd -g 10001 appgroup \
    && useradd -u 10001 -g appgroup -m -s /usr/sbin/nologin appuser

# Create app dir with correct ownership
WORKDIR /app
RUN chown -R appuser:appgroup /app

USER appuser:appgroup
